# :jack_o_lantern: Modal-Importance-based-Improved-lifelog-prediction-performance
> ë³¸ ì—°êµ¬ëŠ” ì œ2íšŒ ETRI íœ´ë¨¼ì´í•´ ì¸ê³µì§€ëŠ¥ ë…¼ë¬¸ê²½ì§„ëŒ€íšŒì—ì„œ [í•œêµ­ì „ìí†µì‹ ì—°êµ¬ì›ì›ì¥ìƒì„ ìˆ˜ìƒ](https://www.etri.re.kr/file/bbsFileDownJSON.etri?b_board_id=ETRI06&f_idx=11624)í•œ 'ë¼ì´í”„ë¡œê·¸ ì˜ˆì¸¡ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ ë‹¤ì¤‘ ì¸ìŠ¤í„´ìŠ¤ ê¸°ë°˜ ê°œì¸ë³„ ëª¨ë‹¬ ì£¼ìš”ë„ ì¶”ì¶œ ë° ê·¸ë£¹í™”' ë…¼ë¬¸ì—ì„œ êµ¬í˜„í•œ ì‹¤í—˜ì„ ì¬í˜„í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.

ë©€í‹° ëª¨ë‹¬ ì„¼ì„œ ë°ì´í„°ë¥¼ í™œìš©í•´ì„œ ì‚¬ìš©ìë“¤ì˜ ë¼ì´í”„ë¡œê·¸ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë¬¸ì œëŠ” ê°œì¸ì˜ ë‹¤ì–‘ì„±ìœ¼ë¡œ ì¸í•´ ë°œìƒë˜ëŠ” í¸ì°¨ë¡œ ì¸í•´ ì–´ë ¤ì›€ì´ ìˆìŠµë‹ˆë‹¤.

ë³¸ ì—°êµ¬ì—ì„œëŠ” ê° ê°œì¸ì—ê²Œì„œ ì‚¬ìš©ìë“¤ì˜ **ë¼ì´í”„ë¡œê·¸ ì˜ˆì¸¡ì— ì˜í–¥ì„ ë§ì´ ì£¼ëŠ” ëª¨ë‹¬ ì£¼ìš”ë„**ë¥¼ ì„¤ëª…ê°€ëŠ¥í•œ ëª¨ë¸ì¸ **Mulitple Instance learning(MIL)ì„ ìµœì´ˆë¡œ ì‚¬ìš©í•´ì„œ ì¶”ì¶œ**í•˜ê³ , ì¶”ì¶œí•œ ëª¨ë‹¬ ì£¼ìš”ë„ë¥¼ ì‚¬ìš©í•´ì„œ **ê·¸ë£¹ë³„ ì˜ˆì¸¡ ëª¨ë¸ì´ ì „ì²´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œ ë°©ë²•ë¡ ë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ë‹¤ëŠ” ê²ƒ**ì„ ë³´ì˜€ìŠµë‹ˆë‹¤.

## :apple: ê¸°ëŒ€ íš¨ê³¼
**1. ìœ ì €ì˜ ë¼ì´í”„ë¡œê·¸ ì •ë³´ì— ëŒ€í•œ í–¥ìƒëœ ë¶„ì„**
> ê° ìœ ì €ì˜ ë¼ì´í”„ë¡œê·¸ ì •ë³´ëŠ” ë³µì¡í•œ íŠ¹ì„±ì„ ê°€ì ¸, ìœ ì €ë“¤ì„ ê·¸ë£¹í™” ë° ë¶„ì„í•˜ê¸° ì–´ë µë‹¤ëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ë°˜ë©´ ë³¸ ì—°êµ¬ë¥¼ í™œìš©í•˜ë©´, MIL ê¸°ë°˜ ì¸ê³µì§€ëŠ¥ ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ìœ ì €ë“¤ì˜ ì„±í–¥ ë¶„ì„í•˜ê³  ê·¸ë£¹í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
 
**2. ê¸°ì¡´ ê¸€ë¡œë²Œ ëª¨ë¸ ëŒ€ë¹„ í–¥ìƒëœ ì„±ëŠ¥ì˜ ëª¨ë¸ ê°œë°œ**
> ê¸°ì¡´ì˜ ë°©ì‹ë“¤ì€ ë‹¤ì–‘í•œ íŠ¹ì„±ì„ ê°€ì§„ ëª¨ë“  ìœ ì €ë“¤ì„ í•˜ë‚˜ë¡œ ë¬¶ì–´, ì¼ë°˜í™” ê³¼ì •ì—ì„œ ì„±ëŠ¥ì´ ì¤„ì–´ë“œëŠ” ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ë°˜ë©´ ë³¸ ì—°êµ¬ì—ì„œ ì œì•ˆí•˜ëŠ” ë°©ë²•ë¡ ì€ ë¹„ìŠ·í•œ íŠ¹ì„±ì„ ê°€ì§€ëŠ” ìœ ì €ë“¤ì„ ë¬¶ì–´ í•™ìŠµì‹œì¼œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤.

## ğŸŒ²Working Enviornment
* Python Version : 3.7.13
* torch
* seaborn
* numpy
* pandas

## ğŸ—ƒï¸Dataset
* 2019ë…„ ìœ ì € ë¼ì´í”„ë¡œê·¸ ë°ì´í„°ì…‹: https://nanum.etri.re.kr/share/schung1/ETRILifelogDataset2020?lang=ko_KR

## ğŸ—‚ï¸ê° ë””ë ‰í† ë¦¬ë³„ ì„¤ëª…
**human_lifelog_mil_pytorch:**
> ë³¸ ì—°êµ¬ì—ì„œ ì‚¬ìš©í•œ ëª¨ë‹¬ ì£¼ìš”ë„ë¥¼ ì¶”ì¶œí•˜ëŠ” Multiple Instance Learning modelì˜ structureê³¼ ê·¸ë£¹ë³„ ë¼ì´í”„ë¡œê·¸ ì˜ˆì¸¡ ëª¨ë¸ structure, ê·¸ ì™¸ì— ì‹¤í—˜ì— í•„ìš”í•œ ê¸°ë³¸ì ì¸ ì½”ë“œë“¤ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤.
>> **FocalLoss.py:**
>> - ë³¸ ì—°êµ¬ì—ì„œ ì˜ˆì¸¡í•˜ëŠ” ë¼ë²¨ì¸ ë¶ˆê· í˜•ì´ ìˆê¸° ë•Œë¬¸ì—, ë¶ˆê· í˜•í•œ ë¶„ë¥˜ ë¬¸ì œì— ë„ì›€ì´ ë˜ëŠ” FocalLossë¥¼ ì‚¬ìš©(https://github.com/AdeelH/pytorch-multi-class-focal-loss ì—ì„œ êµ¬í˜„ëœ ì½”ë“œë¥¼ ì‚¬ìš©)í–ˆìŠµë‹ˆë‹¤.
>> **human_lifelog_mil_pytorch.py:**
>> - ë©€í‹° ëª¨ë‹¬ ë¬¸ì œë¥¼ Multiple Instnace Learning êµ¬ì¡°ë¡œ í•´ê²°í•˜ê²Œ í•´ì£¼ëŠ” ì½”ë“œì…ë‹ˆë‹¤.
>>**human_lifelog_predictor.py:**
>> - ê° ê·¸ë£¹ ë§ì¶¤ ë¼ì´í”„ë¡œê·¸ ì˜ˆì¸¡ ëª¨ë¸ classê°€ ìˆëŠ” ì½”ë“œì…ë‹ˆë‹¤.
>>**modules.py:**
>> - ë³¸ ì—°êµ¬ì—ì„œëŠ” ê¸¸ì´ê°€ ë§¤ìš° ê¸´ ì‹œê³„ì—´ ë°ì´í„°ì˜ ì •ë³´ë¥¼ ë¹ ë¥´ê³  ì˜ ë°˜ì˜í•˜ëŠ” Cuasal dilated Convolution(https://github.com/flaviagiammarino/usrl-mts-pytorch ì—ì„œ êµ¬í˜„ëœ ì½”ë“œë¥¼ ì‚¬ìš©)ì„ ì¸ì½”ë”ë¡œ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.
>>**utils.py:**
>> - multi classification ë¬¸ì œì—ì„œ F1 scoreì„ êµ¬í•˜ê¸° ìœ„í•´ ë”°ë¡œ êµ¬í˜„í•œ ì½”ë“œì…ë‹ˆë‹¤.

**preprocess:**
> 2019ë…„ ìœ ì € ë¼ì´í”„ë¡œê·¸ ë°ì´í„°ì…‹ì„ ì…ë ¥ê°€ëŠ¥í•˜ê²Œ ì „ì²˜ë¦¬í•´ì£¼ëŠ” ì½”ë“œë“¤ì´ ìœ„ì¹˜í•œ ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ë¨¼ì € ë°ì´í„°ì…‹ì„ ë‹¤ìš´ë°›ì•„ì•¼ í•©ë‹ˆë‹¤.
â”‚  â”œâ”€â”€Dataset Preprocessor.ipynb: ì„œë¡œ ë‹¤ë¥¸ ê³µê°„ì—ì„œ ì¸¡ì •ëœ ê° ë¼ì´í”„ë¡œê·¸ ëª¨ë‹¬ë¦¬í‹°ì˜ ì •ë³´ë¥¼ í•œë²ˆì— ì…ë ¥ë°›ì„ ìˆ˜ ìˆê²Œ DataFrameìœ¼ë¡œ ë³€í™˜í•´ì£¼ëŠ” ì „ì²˜ë¦¬ ì½”ë“œì…ë‹ˆë‹¤.
â”‚  â”œâ”€â”€Tension á„‹á…¨á„á…³á†¨ á„ƒá…¦á„‹á…µá„á…¥ á„Œá…¥á†«á„á…¥á„…á…µ á„á…©á„ƒá…³.ipynb: ê° ëª¨ë‹¬ë¦¬í‹°ê°€ ìˆ˜ì§‘ëœ ì‹œì ì— ëŒ€ì‘ë˜ëŠ” ë¼ë²¨ì„ ì¶”ì¶œí•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤. ì´ ì½”ë“œë¥¼ í†µí•´ ê° ìœ ì €ì˜ ê° ì‹œì ì— ëŒ€ì‘ë˜ëŠ” ë¼ë²¨ì„ ìˆ˜ì§‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
â”œâ”€â”€modal_importance_extract: 2019ë…„ ìœ ì € ì¤‘ 101ë²ˆ ì‚¬ìš©ìë¥¼ ëŒ€ìƒìœ¼ë¡œ MIL ëª¨ë¸ì„ ì ìš©í•˜ì—¬ í•´ë‹¹ ìœ ì €ì˜ ê° ëª¨ë‹¬ ë³„ ì¤‘ìš”ë„ë¥¼ ì¶”ì¶œí•˜ëŠ” ì½”ë“œë“¤ì´ ìˆëŠ” ë””ë ‰í† ë¦¬ì…ë‹ˆë‹¤. ì´ ì½”ë“œë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ë¥¸ ìœ ì €ë“¤ì˜ ë°ì´í„°ì—ì„œë„ ì •ë³´ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
â”‚  â”œâ”€â”€101_tension_MIL_Model Train code.ipynb: 2019ë…„ ìœ ì € ì¤‘ 101ë²ˆ ì‚¬ìš©ìë¥¼ ëŒ€ìƒìœ¼ë¡œ Multiple Instance Learning ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í•™ìŠµì„ í•˜ëŠ” ì˜ˆì œ ì½”ë“œì…ë‹ˆë‹¤.
â”‚  â”œâ”€â”€101_test_á„†á…©á„ƒá…¡á†¯ á„Œá…®á„‹á…­á„ƒá…© á„á…®á„á…®á†¯.ipynb: 2019ë…„ ìœ ì € ì¤‘ 101ë²ˆ ì‚¬ìš©ìë¥¼ ëŒ€ìƒìœ¼ë¡œ í•™ìŠµëœ ëª¨ë¸ì„ ì‚¬ìš©í•´ì„œ 101ë²ˆ ì‚¬ìš©ìì˜ test dataë¡œë¶€í„° ëª¨ë‹¬ ì£¼ìš”ë„ë¥¼ ì¶”ì¶œí•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤
â”œâ”€â”€visualizing_clustering
â”‚  â”œâ”€â”€raw data based cluster_T-SNE.ipynb: ê° ìœ ì €ì˜ ê° ëª¨ë‹¬ì— ëŒ€í•œ raw ë°ì´í„° ì •ë³´ë¥¼ TSNEë¥¼ ì‚¬ìš©í•˜ì—¬ 2ì°¨ì›ìœ¼ë¡œ ì‹œê°í™”í•©ë‹ˆë‹¤.
â”‚  â”œâ”€â”€modal importance value based cluster_T-SNE.ipynb: ê° ìœ ì €ì— ëŒ€í•´ì„œ ì¶”ì¶œëœ ëª¨ë‹¬ì˜ ê° ì¤‘ìš”ë„ë“¤ì„ 2ì°¨ì›ìœ¼ë¡œ ì‹œê°í™” ë° í´ë£¨ìŠ¤í„°ë§ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
â”œâ”€â”€general_model
â”‚  â”œâ”€â”€á„€á…³á„…á…®á†¸ á„†á…µá†¾ á„Œá…¥á†«á„á…¦ á„ƒá…¦á„‹á…µá„á…¥á„‰á…¦á†ºá„‹á…¦ á„ƒá…¢á„’á…¡á†« tension á„‹á…¨á„á…³á†¨ á„á…©á„ƒá…³.py: ë§Œë“¤ì–´ì§„ ê·¸ë£¹ì„ í†µí•´ ê° ê·¸ë£¹ë³„ Tension ë¼ë²¨ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ëŠ” ì½”ë“œì™€, ì „ì²´ ë°ì´í„°ë¡œ Tension ë¼ë²¨ì„ ì˜ˆì¸¡í•˜ëŠ” ì½”ë“œì…ë‹ˆë‹¤.


## ë°ì´í„° ì‹œê°í™” ([visualizing_clustering](https://github.com/ZangZaeSeok/Modal-Importance-based-Improved-lifelog-prediction-performance/tree/main/visualizing_clustering))
> MILì„ ì ìš©í•˜ê¸° ì´ì „ ê° ìœ ì €ì˜ raw data ì‹œê°í™”: **íŠ¹ì§•ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²ƒ**ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![á„ƒá…¡á„‹á…®á†«á„…á…©á„ƒá…³](https://github.com/user-attachments/assets/a7fab041-2818-4230-8b0b-2f5352fbe27b)
> MILì„ í†µí•´ ì¶”ì¶œëœ ê° ìœ ì €ì˜ ëª¨ë‹¬ ì¤‘ìš”ë„ ì‹œê°í™”: **ê° ìœ ì € ë³„ë¡œ íŠ¹ì§•ì´ ì¡´ì¬**í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
![á„á…³á†¯á„…á…®á„‰á…³á„á…¥1](https://github.com/user-attachments/assets/68affe1e-f226-4b33-bdf5-4629b283d5b9)
> ê° ì‚¬ìš©ì ê·¸ë£¹ ë³„ ëª¨ë‹¬ ì¤‘ìš”ë„ ì‹œê°í™”
![modal importance](https://github.com/user-attachments/assets/e0c0f61a-d495-4d8b-9bf3-445239ae834a)

  
